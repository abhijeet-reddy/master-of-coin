-- Master of Coin - Comprehensive Seed Data
-- This file contains test data for development and testing

-- Enable UUID extension (if not already enabled)
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- Clear existing data (in correct order to respect foreign keys)
TRUNCATE TABLE budget_ranges CASCADE;
TRUNCATE TABLE budgets CASCADE;
TRUNCATE TABLE transaction_splits CASCADE;
TRUNCATE TABLE transactions CASCADE;
TRUNCATE TABLE people CASCADE;
TRUNCATE TABLE categories CASCADE;
TRUNCATE TABLE accounts CASCADE;
TRUNCATE TABLE users CASCADE;

-- Insert Test User
-- Password: knowledge-is-power (hashed with argon2)
INSERT INTO users (id, username, email, password_hash, name, created_at, updated_at)
VALUES (
    '00000000-0000-0000-0000-000000000001',
    'little-finger',
    'little-finger@master-of-coin.com',
    '$argon2id$v=19$m=19456,t=2,p=1$VE5TSUxPR0lOSEFTSA$8K0VQV7lZ8K0VQV7lZ8K0VQV7lZ8K0VQV7lZ8K0VQV7lZ',
    'Petyr Baelish',
    CURRENT_TIMESTAMP,
    CURRENT_TIMESTAMP
);

-- Insert Default Categories
INSERT INTO categories (id, user_id, name, icon, color, parent_category_id, created_at, updated_at)
VALUES
    ('10000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001', 'Food & Dining', 'üçî', '#FF6B6B', NULL, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('10000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000001', 'Transportation', 'üöó', '#4ECDC4', NULL, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('10000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000001', 'Shopping', 'üõçÔ∏è', '#95E1D3', NULL, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('10000000-0000-0000-0000-000000000004', '00000000-0000-0000-0000-000000000001', 'Bills & Utilities', 'üí°', '#F38181', NULL, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('10000000-0000-0000-0000-000000000005', '00000000-0000-0000-0000-000000000001', 'Entertainment', 'üéÆ', '#AA96DA', NULL, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('10000000-0000-0000-0000-000000000006', '00000000-0000-0000-0000-000000000001', 'Healthcare', 'üè•', '#FCBAD3', NULL, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('10000000-0000-0000-0000-000000000007', '00000000-0000-0000-0000-000000000001', 'Income', 'üí∞', '#A8E6CF', NULL, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('10000000-0000-0000-0000-000000000008', '00000000-0000-0000-0000-000000000001', 'Other', 'üì¶', '#C7CEEA', NULL, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);

-- Insert Sample Accounts
INSERT INTO accounts (id, user_id, name, type, currency, notes, created_at, updated_at)
VALUES
    ('20000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001', 'Checking Account', 'CHECKING', 'EUR', 'Primary checking account', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('20000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000001', 'Savings Account', 'SAVINGS', 'EUR', 'Emergency fund', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('20000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000001', 'Credit Card', 'CREDIT_CARD', 'EUR', 'Rewards credit card', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);

-- Insert Sample People
INSERT INTO people (id, user_id, name, email, phone, notes, created_at, updated_at)
VALUES
    ('30000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001', 'Varys', 'varys@master-of-coin.com', '+353-1-234-5678', 'The Spider', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('30000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000001', 'Pycelle', 'pycelle@master-of-coin.com', '+353-1-234-5679', 'Grand Maester', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);

-- Insert Sample Transactions (last 30 days)
INSERT INTO transactions (id, user_id, account_id, category_id, title, amount, date, notes, created_at, updated_at)
VALUES
    -- Income
    ('40000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000007', 'Monthly Salary', 3500.00, CURRENT_TIMESTAMP - INTERVAL '1 day', 'October salary', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    
    -- Expenses
    ('40000000-0000-0000-0000-000000000002', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', 'Grocery Shopping', -85.50, CURRENT_TIMESTAMP - INTERVAL '2 days', 'Weekly groceries', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('40000000-0000-0000-0000-000000000003', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000002', 'Fuel', -60.00, CURRENT_TIMESTAMP - INTERVAL '3 days', 'Gas station', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('40000000-0000-0000-0000-000000000004', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000004', 'Electricity Bill', -120.00, CURRENT_TIMESTAMP - INTERVAL '5 days', 'Monthly electricity', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('40000000-0000-0000-0000-000000000005', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000005', 'Netflix Subscription', -15.99, CURRENT_TIMESTAMP - INTERVAL '7 days', 'Monthly subscription', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('40000000-0000-0000-0000-000000000006', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', 'Restaurant Dinner', -75.00, CURRENT_TIMESTAMP - INTERVAL '10 days', 'Dinner with friends', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('40000000-0000-0000-0000-000000000007', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000003', 'Online Shopping', -150.00, CURRENT_TIMESTAMP - INTERVAL '12 days', 'Clothes and accessories', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('40000000-0000-0000-0000-000000000008', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000006', 'Pharmacy', -45.50, CURRENT_TIMESTAMP - INTERVAL '15 days', 'Medications', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('40000000-0000-0000-0000-000000000009', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', 'Public Transport', -30.00, CURRENT_TIMESTAMP - INTERVAL '18 days', 'Monthly pass', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('40000000-0000-0000-0000-000000000010', '00000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', 'Coffee Shop', -12.50, CURRENT_TIMESTAMP - INTERVAL '20 days', 'Morning coffee', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);

-- Insert Sample Transaction Splits (for shared expenses)
INSERT INTO transaction_splits (id, transaction_id, person_id, amount, created_at, updated_at)
VALUES
    ('50000000-0000-0000-0000-000000000001', '40000000-0000-0000-0000-000000000006', '30000000-0000-0000-0000-000000000001', 37.50, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    ('50000000-0000-0000-0000-000000000002', '40000000-0000-0000-0000-000000000006', '30000000-0000-0000-0000-000000000002', 37.50, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);

-- Insert Sample Budget
INSERT INTO budgets (id, user_id, name, filters, created_at, updated_at)
VALUES
    ('60000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000001', 'Monthly Food Budget', 
     '{"category_id": "10000000-0000-0000-0000-000000000001", "account_ids": ["*"]}'::jsonb, 
     CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);

-- Insert Sample Budget Range
INSERT INTO budget_ranges (id, budget_id, limit_amount, period, start_date, end_date, created_at, updated_at)
VALUES
    ('70000000-0000-0000-0000-000000000001', '60000000-0000-0000-0000-000000000001', 500.00, 'MONTHLY', 
     DATE_TRUNC('month', CURRENT_DATE)::date, 
     (DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month - 1 day')::date, 
     CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);

-- Display summary
SELECT 'Seed data loaded successfully!' as status;
SELECT COUNT(*) as user_count FROM users;
SELECT COUNT(*) as category_count FROM categories;
SELECT COUNT(*) as account_count FROM accounts;
SELECT COUNT(*) as people_count FROM people;
SELECT COUNT(*) as transaction_count FROM transactions;
SELECT COUNT(*) as split_count FROM transaction_splits;
SELECT COUNT(*) as budget_count FROM budgets;
SELECT COUNT(*) as budget_range_count FROM budget_ranges;